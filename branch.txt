a some modifications in tak, more in tak

b

c some modifications in main

